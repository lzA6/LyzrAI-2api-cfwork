# ğŸš€ Lyzr AI æ——èˆ°æ™ºèƒ½æ¢çº½ (Flagship Intelligent Hub)

<div align="center">

![Version](https://img.shields.io/badge/Version-3.0.1-7aa2f7.svg?style=for-the-badge&logo=cloudflare)
![License](https://img.shields.io/badge/License-Apache%202.0-9ece6a.svg?style=for-the-badge&logo=apache)
![Platform](https://img.shields.io/badge/Platform-Cloudflare%20Workers-f7768e.svg?style=for-the-badge&logo=cloudflare)

**âœ¨ ä¸–ç•Œçº§ Serverless æ¶æ„å¸ˆä¸ºæ‚¨å€¾åŠ›æ‰“é€ çš„è‰ºæœ¯å“çº§ AI æ™ºèƒ½ç½‘å…³ âœ¨**

</div>

## ğŸ“– ç›®å½•
- [ğŸ¯ é¡¹ç›®ç®€ä»‹](#-é¡¹ç›®ç®€ä»‹)
- [âœ¨ æ ¸å¿ƒç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§)
- [ğŸš€ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [ğŸ—ï¸ æ¶æ„åŸç†](#ï¸-æ¶æ„åŸç†)
- [ğŸ”§ è¯¦ç»†é…ç½®](#-è¯¦ç»†é…ç½®)
- [ğŸ¨ äº¤äº’é¢æ¿](#-äº¤äº’é¢æ¿)
- [ğŸ“Š ä½¿ç”¨åœºæ™¯](#-ä½¿ç”¨åœºæ™¯)
- [ğŸ”® æœªæ¥è§„åˆ’](#-æœªæ¥è§„åˆ’)
- [ğŸ“ é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)
- [ğŸ› ï¸ æŠ€æœ¯ç»†èŠ‚](#ï¸-æŠ€æœ¯ç»†èŠ‚)
- [ğŸ¤ è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)
- [ğŸ“„ å¼€æºåè®®](#-å¼€æºåè®®)

## ğŸ¯ é¡¹ç›®ç®€ä»‹

### è¿™æ˜¯ä»€ä¹ˆï¼ŸğŸ¤”
**Lyzr AI æ——èˆ°æ™ºèƒ½æ¢çº½** æ˜¯ä¸€ä¸ªåŸºäº Cloudflare Workers æ„å»ºçš„**ä¼ä¸šçº§ AI æ™ºèƒ½ç½‘å…³**ï¼Œå®ƒå°±åƒæ˜¯ä¸€ä¸ª"AI äº¤é€šæŒ‡æŒ¥ä¸­å¿ƒ" ğŸš¦ï¼Œèƒ½å¤Ÿï¼š

- ğŸ­ **æ™ºèƒ½è·¯ç”±**ï¼šå°†ç”¨æˆ·è¯·æ±‚åŠ¨æ€åˆ†é…åˆ°ä¸åŒçš„ AI Agent
- ğŸ”„ **ä¼ªæµå¼ä¼ è¾“**ï¼šæ¨¡æ‹Ÿ OpenAI çš„æµå¼å“åº”ä½“éªŒ
- ğŸ¨ **ç²¾ç¾é¢æ¿**ï¼šå†…ç½®åŠŸèƒ½å®Œæ•´çš„ Web ç®¡ç†ç•Œé¢
- ğŸ”Œ **å¹¿æ³›å…¼å®¹**ï¼šæ”¯æŒæ‰€æœ‰ OpenAI å…¼å®¹çš„å®¢æˆ·ç«¯

### è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼ŸğŸ¯
| é—®é¢˜åœºæ™¯ | ä¼ ç»Ÿæ–¹æ¡ˆ | æˆ‘ä»¬çš„æ–¹æ¡ˆ |
|---------|---------|-----------|
| å¤šä¸ª AI Agent ç®¡ç†æ··ä¹± | éœ€è¦é…ç½®å¤šä¸ª API å¯†é’¥å’Œç«¯ç‚¹ | **ç»Ÿä¸€å…¥å£**ï¼Œä¸€é”®åˆ‡æ¢ |
| æµå¼å“åº”æˆæœ¬é«˜ | éœ€è¦æ˜‚è´µçš„å®æ—¶è¿æ¥ | **ä¼ªæµå¼**ï¼Œä½æˆæœ¬å®ç°ç›¸ä¼¼ä½“éªŒ |
| å®¢æˆ·ç«¯å…¼å®¹æ€§å·® | æ¯ä¸ªå®¢æˆ·ç«¯éœ€è¦å•ç‹¬é…ç½® | **OpenAI å…¼å®¹**ï¼Œå¼€ç®±å³ç”¨ |
| éƒ¨ç½²å¤æ‚ | éœ€è¦æœåŠ¡å™¨å’Œå¤æ‚é…ç½® | **Serverless**ï¼Œ5åˆ†é’Ÿéƒ¨ç½² |

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸŒŸ æ——èˆ°çº§åŠŸèƒ½çŸ©é˜µ

| ç‰¹æ€§ç±»åˆ« | åŠŸèƒ½ç‚¹ | çŠ¶æ€ | äº®ç‚¹ |
|---------|--------|------|------|
| **æ ¸å¿ƒæ¶æ„** | å¤š Agent åŠ¨æ€è·¯ç”± | âœ… | ğŸ¯ æ™ºèƒ½è´Ÿè½½å‡è¡¡ |
| | ä¼ªæµå¼ä¼ è¾“ | âœ… | âš¡ ä½æˆæœ¬é«˜ä½“éªŒ |
| | å…¨å±€é”™è¯¯å¤„ç† | âœ… | ğŸ›¡ï¸ æ°¸ä¸å´©æºƒ |
| **ç”¨æˆ·ä½“éªŒ** | æ——èˆ°äº¤äº’é¢æ¿ | âœ… | ğŸ¨ æè‡´è§†è§‰ä½“éªŒ |
| | å®æ—¶ API æµ‹è¯•å™¨ | âœ… | ğŸ§ª å†…ç½®è°ƒè¯•å·¥å…· |
| | Toast é€šçŸ¥ç³»ç»Ÿ | âœ… | ğŸ’« ä¼˜é›…åé¦ˆ |
| **å…¼å®¹æ€§** | OpenAI API å…¼å®¹ | âœ… | ğŸ”Œ å¹¿æ³›å®¢æˆ·ç«¯æ”¯æŒ |
| | CORS è·¨åŸŸæ”¯æŒ | âœ… | ğŸŒ å…¨å¹³å°å¯ç”¨ |
| **ä¼ä¸šçº§** | API å¯†é’¥è®¤è¯ | âœ… | ğŸ” å®‰å…¨å¯é  |
| | é…ç½®åŒ–éƒ¨ç½² | âœ… | âš™ï¸ çµæ´»å¯æ‰©å±• |

### ğŸ¯ æŠ€æœ¯äº®ç‚¹è¯„çº§

| æŠ€æœ¯ç‚¹ | éš¾åº¦ | å®ç”¨æ€§ | åˆ›æ–°æ€§ | ç»¼åˆè¯„åˆ† |
|--------|------|--------|--------|----------|
| Cloudflare Workers | â­â­ | â­â­â­â­â­ | â­â­â­â­ | ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ |
| åŠ¨æ€ Agent è·¯ç”± | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ |
| ä¼ªæµå¼ä¼ è¾“ | â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ |
| Serverless æ¶æ„ | â­â­ | â­â­â­â­â­ | â­â­â­ | ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ |
| å‰ç«¯è¯­æ³•å¥å£®æ€§ | â­â­â­ | â­â­â­â­ | â­â­â­ | ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ğŸ–ï¸ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### âš¡ æ‡’äººä¸€é”®éƒ¨ç½² (5åˆ†é’Ÿæå®šï¼)

#### æ–¹æ³•ä¸€ï¼šCloudflare Dashboard éƒ¨ç½² ğŸ–¥ï¸
1. **å‡†å¤‡é˜¶æ®µ** ğŸ“¦
   ```bash
   # å…‹éš†ä»“åº“åˆ°æœ¬åœ°
   git clone https://github.com/lzA6/LyzrAI-2api-cfwork.git
   cd LyzrAI-2api-cfwork
   ```

2. **Cloudflare æ§åˆ¶å°æ“ä½œ** ğŸ®
   - ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com)
   - è¿›å…¥ **Workers & Pages** â†’ **Create Application**
   - é€‰æ‹© **Create Worker**
   - å°† `worker.js` å†…å®¹å¤åˆ¶åˆ°ç¼–è¾‘å™¨
   - ç‚¹å‡» **Deploy** ğŸš€

3. **é…ç½®ç¯å¢ƒå˜é‡** âš™ï¸
   - åœ¨ Worker è®¾ç½®ä¸­ä¿®æ”¹ `GATEWAY_API_KEY`
   - å»ºè®®ä½¿ç”¨å¼ºå¯†ç ç”Ÿæˆå™¨ç”Ÿæˆå¤æ‚å¯†é’¥

#### æ–¹æ³•äºŒï¼šWrangler CLI éƒ¨ç½² ğŸ”§
```bash
# å®‰è£… Wrangler CLI
npm install -g wrangler

# ç™»å½• Cloudflare
wrangler login

# éƒ¨ç½² Worker
wrangler deploy
```

#### æ–¹æ³•ä¸‰ï¼šä¸€é”®è„šæœ¬éƒ¨ç½² ğŸ¤–
```bash
# ä½¿ç”¨è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ï¼ˆåç»­ç‰ˆæœ¬æä¾›ï¼‰
curl -fsSL https://raw.githubusercontent.com/lzA6/LyzrAI-2api-cfwork/main/deploy.sh | bash
```

### ğŸ¯ éªŒè¯éƒ¨ç½²
éƒ¨ç½²æˆåŠŸåï¼Œè®¿é—®ä½ çš„ Worker åœ°å€ï¼š
```
https://your-worker-name.your-subdomain.workers.dev
```

ä½ åº”è¯¥çœ‹åˆ°ç²¾ç¾çš„æ——èˆ°äº¤äº’é¢æ¿ï¼ğŸ‰

## ğŸ—ï¸ æ¶æ„åŸç†

### ğŸ“Š ç³»ç»Ÿæ¶æ„å›¾

```mermaid
graph TB
    A[ç”¨æˆ·å®¢æˆ·ç«¯] --> B{Cloudflare Worker}
    B --> C[èº«ä»½è®¤è¯]
    C --> D[è¯·æ±‚è·¯ç”±]
    D --> E[Agent é€‰æ‹©å™¨]
    E --> F[ä¸Šæ¸¸ API è°ƒç”¨]
    F --> G[Lyzr AI åç«¯]
    G --> H[å“åº”å¤„ç†]
    H --> I[ä¼ªæµå¼å¼•æ“]
    I --> J[æ ¼å¼è½¬æ¢]
    J --> A
    
    K[Web é¢æ¿] --> B
    L[ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯] --> B
    
    subgraph "æ™ºèƒ½è·¯ç”±æ ¸å¿ƒ"
        E --> M[Claude Sonnet 3.7]
        E --> N[Sonar Pro]
        E --> O[è‡ªå®šä¹‰ Agent]
    end
    
    style B fill:#7aa2f7,stroke:#333,stroke-width:2px
    style E fill:#9ece6a,stroke:#333,stroke-width:2px
```

### ğŸ”„ è¯·æ±‚å¤„ç†æµç¨‹

1. **è¯·æ±‚æ¥æ”¶** ğŸ“¥
   ```javascript
   // 1. å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ° Worker
   POST /v1/chat/completions
   Authorization: Bearer {API_KEY}
   ```

2. **æ™ºèƒ½è·¯ç”±** ğŸ§­
   ```javascript
   // 2. Worker è§£æè¯·æ±‚ï¼Œé€‰æ‹©å¯¹åº” Agent
   const modelName = requestBody.model; // ä¾‹å¦‚ 'Claude Sonnet 3.7'
   const agentConfig = AGENT_MAPPING_CONFIG.AGENTS[modelName];
   ```

3. **ä¸Šæ¸¸é€šä¿¡** ğŸ”—
   ```javascript
   // 3. è½¬å‘è¯·æ±‚åˆ° Lyzr ä¸Šæ¸¸ API
   const upstreamResponse = await fetch(UPSTREAM_API_URL, {
     method: 'POST',
     headers: {
       'x-api-key': agentConfig.upstream_api_key, // åŠ¨æ€å¯†é’¥
       'Content-Type': 'application/json'
     },
     body: JSON.stringify(upstreamPayload)
   });
   ```

4. **å“åº”å¤„ç†** ğŸ”„
   ```javascript
   // 4. å¤„ç†ä¸Šæ¸¸å“åº”ï¼Œè½¬æ¢ä¸º OpenAI æ ¼å¼
   const answer = upstreamData.response;
   const completionData = {
     choices: [{
       message: { role: "assistant", content: answer }
     }]
   };
   ```

5. **ä¼ªæµå¼è¾“å‡º** ğŸŒŠ
   ```javascript
   // 5. å¦‚æœéœ€è¦æµå¼å“åº”ï¼Œå¯åŠ¨ä¼ªæµå¼å¼•æ“
   if (requestBody.stream) {
     const stream = createPseudoStream(answer, modelName);
     return new Response(stream, {
       headers: { 'Content-Type': 'text/event-stream' }
     });
   }
   ```

### ğŸ§  æ ¸å¿ƒæŠ€æœ¯åŸç†

#### 1. åŠ¨æ€ Agent è·¯ç”± ğŸ¯
```javascript
// åŸç†ï¼šä½¿ç”¨é…ç½®æ˜ å°„è¡¨å®ç°æ™ºèƒ½è·¯ç”±
const AGENT_MAPPING_CONFIG = {
  AGENTS: {
    'Claude Sonnet 3.7': {
      agent_id: '68a432d16e1baa11945cbcb3',
      upstream_api_key: 'sk-default-qXBq2tAincHBVJD4T3ttQkA9S20dETVb'
    },
    // æ›´å¤š Agent...
  }
};
```

**æŠ€æœ¯è¦ç‚¹**ï¼š
- ğŸ”‘ **å¯†é’¥éš”ç¦»**ï¼šæ¯ä¸ª Agent ä½¿ç”¨ç‹¬ç«‹ API å¯†é’¥
- ğŸ¯ **æ¨¡å‹æ˜ å°„**ï¼šå®¢æˆ·ç«¯æ¨¡å‹å â†’ ä¸Šæ¸¸ Agent ID
- âš¡ **åŠ¨æ€é€‰æ‹©**ï¼šè¿è¡Œæ—¶æ ¹æ®è¯·æ±‚åŠ¨æ€é€‰æ‹© Agent

#### 2. ä¼ªæµå¼ä¼ è¾“å¼•æ“ âš¡
```javascript
function createPseudoStream(fullText, modelName) {
  return new ReadableStream({
    async start(controller) {
      // å°†å®Œæ•´æ–‡æœ¬åˆ†å—å‘é€
      for (let i = 0; i < fullText.length; i += CHUNK_SIZE) {
        const chunkContent = fullText.substring(i, i + CHUNK_SIZE);
        // æ„å»º SSE æ ¼å¼æ•°æ®å—
        const chunk = { choices: [{ delta: { content: chunkContent } }] };
        controller.enqueue(encoder.encode(`data: ${JSON.stringify(chunk)}\n\n`));
        // æ·»åŠ å»¶è¿Ÿæ¨¡æ‹ŸçœŸå®æµå¼
        await new Promise(resolve => setTimeout(resolve, DELAY_MS));
      }
    }
  });
}
```

**æŠ€æœ¯è¦ç‚¹**ï¼š
- ğŸ§© **åˆ†å—å¤„ç†**ï¼šå°†å“åº”æ–‡æœ¬åˆ†æˆå°æ•°æ®å—
- â±ï¸ **æ—¶åºæ§åˆ¶**ï¼šé€šè¿‡å»¶è¿Ÿæ¨¡æ‹ŸçœŸå®æ‰“å­—æ•ˆæœ
- ğŸ“¡ **SSE åè®®**ï¼šä½¿ç”¨ Server-Sent Events æ ‡å‡†åè®®
- ğŸ­ **ç”¨æˆ·ä½“éªŒ**ï¼šæä¾›ç±»ä¼¼çœŸå®æµå¼çš„äº¤äº’ä½“éªŒ

#### 3. å‰ç«¯è¯­æ³•å¥å£®æ€§åŠ å›º ğŸ›¡ï¸
```javascript
// v3.0.1 å…³é”®ä¿®å¤ï¼šæ¨¡æ¿å­—ç¬¦ä¸²åµŒå¥—é—®é¢˜
// é”™è¯¯å†™æ³•ï¼ˆv3.0ï¼‰ï¼š
modelSelect.innerHTML = `<option>${error.message}</option>`;

// æ­£ç¡®å†™æ³•ï¼ˆv3.0.1ï¼‰ï¼š
modelSelect.innerHTML = '<option>' + error.message + '</option>';
```

**æŠ€æœ¯è¦ç‚¹**ï¼š
- ğŸ› **é—®é¢˜æ ¹æº**ï¼šæ¨¡æ¿å­—ç¬¦ä¸²åœ¨å¤æ‚åµŒå¥—ä¸­äº§ç”Ÿè§£ææ­§ä¹‰
- ğŸ”§ **è§£å†³æ–¹æ¡ˆ**ï¼šç»Ÿä¸€ä½¿ç”¨ '+' æ“ä½œç¬¦æ‹¼æ¥å­—ç¬¦ä¸²
- ğŸ“ˆ **å¥å£®æ€§**ï¼šç¡®ä¿åœ¨æ‰€æœ‰ JavaScript ç¯å¢ƒä¸­ç¨³å®šè¿è¡Œ

## ğŸ”§ è¯¦ç»†é…ç½®

### âš™ï¸ å…¨å±€é…ç½®ä¸­å¿ƒ

```javascript
const GLOBAL_CONFIG = {
  WORKER_NAME: 'Lyzr AI æ——èˆ°æ™ºèƒ½æ¢çº½',
  WORKER_VERSION: '3.0.1',
  GATEWAY_API_KEY: '1', // ğŸ” åŠ¡å¿…ä¿®æ”¹ä¸ºå¼ºå¯†ç ï¼
};

const AGENT_MAPPING_CONFIG = {
  UPSTREAM_API_URL: 'https://agent-prod.studio.lyzr.ai/v3/inference/chat/',
  
  // ğŸ¯ å¤š Agent é…ç½®ä¸­å¿ƒ
  AGENTS: {
    'Claude Sonnet 3.7': {
      agent_id: '68a432d16e1baa11945cbcb3',
      upstream_api_key: 'sk-default-qXBq2tAincHBVJD4T3ttQkA9S20dETVb',
      description: 'å¼ºå¤§çš„ Claude Sonnet 3.7 æ¨¡å‹'
    },
    // ğŸ†• æ·»åŠ æ–° Agent ç¤ºä¾‹ï¼š
    'Your New Agent': {
      agent_id: 'your-agent-id-here',
      upstream_api_key: 'your-api-key-here',
      description: 'æ–° Agent çš„æè¿°'
    }
  },

  // âš¡ æ€§èƒ½è°ƒä¼˜å‚æ•°
  PSEUDO_STREAM_CHUNK_SIZE: 3,    // æµå¼å—å¤§å°
  PSEUDO_STREAM_DELAY_MS: 5,      // æµå¼å»¶è¿Ÿ(ms)
};
```

### ğŸ›ï¸ é…ç½®è¯´æ˜è¡¨

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ | è°ƒä¼˜å»ºè®® |
|--------|------|--------|------|----------|
| `GATEWAY_API_KEY` | string | `'1'` | å®¢æˆ·ç«¯è®¤è¯å¯†é’¥ | ğŸ” **å¿…é¡»ä¿®æ”¹**ï¼Œä½¿ç”¨å¼ºå¯†ç  |
| `PSEUDO_STREAM_CHUNK_SIZE` | number | `3` | æµå¼å—å¤§å° | â¬†ï¸ å¢å¤§ï¼šæ›´å¿«ä½†å¡é¡¿ â¬‡ï¸ å‡å°ï¼šæ›´å¹³æ»‘ä½†æ…¢ |
| `PSEUDO_STREAM_DELAY_MS` | number | `5` | å—é—´å»¶è¿Ÿ | â¬†ï¸ å¢å¤§ï¼šæ›´åƒçœŸäººæ‰“å­— â¬‡ï¸ å‡å°ï¼šå“åº”æ›´å¿« |
| `DEFAULT_MODEL_NAME` | string | `'Claude Sonnet 3.7'` | é»˜è®¤æ¨¡å‹ | ğŸ¯ è®¾ç½®æœ€å¸¸ç”¨æ¨¡å‹ |

## ğŸ¨ äº¤äº’é¢æ¿

### âœ¨ æ——èˆ°çº§ UI/UX è®¾è®¡

#### è§†è§‰è®¾è®¡ç†å¿µ ğŸ¨
- **æ·±è‰²ä¸»é¢˜**ï¼šå‡å°‘çœ¼éƒ¨ç–²åŠ³ï¼Œæå‡ä¸“æ³¨åº¦
- **æ¸å˜è‰²å½©**ï¼šä½¿ç”¨ç°ä»£æ„Ÿå¼ºçš„é…è‰²æ–¹æ¡ˆ
- **å¾®äº¤äº’**ï¼šæŒ‰é’®æ‚¬åœã€åŠ è½½åŠ¨ç”»ç­‰ç»†èŠ‚
- **å“åº”å¼å¸ƒå±€**ï¼šé€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡

#### æ ¸å¿ƒåŠŸèƒ½æ¨¡å— ğŸ§©

1. **å¿«é€Ÿå¼€å§‹åŒºåŸŸ** ğŸš€
   - API åœ°å€å’Œå¯†é’¥ä¸€é”®å¤åˆ¶
   - å¯ç”¨æ¨¡å‹åˆ—è¡¨å±•ç¤º

2. **å®¢æˆ·ç«¯é€‚é…æŒ‡å—** ğŸ“š
   - ChatBoxã€LobeChat ç­‰å®¢æˆ·ç«¯é…ç½®æ•™ç¨‹
   - åˆ†æ­¥éª¤è¯¦ç»†è¯´æ˜

3. **å®æ—¶ API æµ‹è¯•å™¨** ğŸ§ª
   - æ¨¡å‹é€‰æ‹©ä¸‹æ‹‰æ¡†
   - å®æ—¶æµå¼å“åº”å±•ç¤º
   - æ¸…ç©ºå’Œé‡è¯•åŠŸèƒ½

4. **Toast é€šçŸ¥ç³»ç»Ÿ** ğŸ’«
   - ä¼˜é›…çš„åŠ¨ä½œåé¦ˆ
   - è‡ªåŠ¨æ¶ˆå¤±çš„æç¤ºä¿¡æ¯

### ğŸ¯ ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯é…ç½®

#### ChatBox é…ç½®
```
API Base URL: https://your-worker.your-subdomain.workers.dev/v1
API Key: your_gateway_api_key
Model: Claude Sonnet 3.7 (æˆ–å…¶å®ƒå¯ç”¨æ¨¡å‹)
```

#### LobeChat é…ç½®
```yaml
# åœ¨è®¾ç½® â†’ è¯­è¨€æ¨¡å‹ â†’ OpenAI å…¼å®¹æ¥å£ä¸­é…ç½®
baseURL: https://your-worker.your-subdomain.workers.dev/v1
apiKey: your_gateway_api_key
```

#### OpenWebUI é…ç½®
```json
{
  "api_base_url": "https://your-worker.your-subdomain.workers.dev/v1",
  "api_key": "your_gateway_api_key"
}
```

## ğŸ“Š ä½¿ç”¨åœºæ™¯

### ğŸ¢ ä¼ä¸šçº§åº”ç”¨åœºæ™¯

| åœºæ™¯ | ç—›ç‚¹ | è§£å†³æ–¹æ¡ˆ | æ”¶ç›Š |
|------|------|----------|------|
| **å¤šæ¨¡å‹ç®¡ç†** | å¤šä¸ª AI æœåŠ¡é…ç½®å¤æ‚ | ç»Ÿä¸€ç½‘å…³ï¼Œä¸€é”®åˆ‡æ¢ | â±ï¸ èŠ‚çœ 70% é…ç½®æ—¶é—´ |
| **æˆæœ¬ä¼˜åŒ–** | æµå¼ API è´¹ç”¨é«˜æ˜‚ | ä¼ªæµå¼ä¼ è¾“ | ğŸ’° é™ä½ 90% æµå¼æˆæœ¬ |
| **å®¢æˆ·ç«¯å…¼å®¹** | ä¸åŒå®¢æˆ·ç«¯é…ç½®ä¸ä¸€ | OpenAI æ ‡å‡†å…¼å®¹ | ğŸ”Œ å¼€ç®±å³ç”¨ |
| **å¿«é€ŸåŸå‹** | å¼€å‘æµ‹è¯•ç¯å¢ƒæ­å»ºæ…¢ | Serverless éƒ¨ç½² | ğŸš€ 5åˆ†é’Ÿä¸Šçº¿ |

### ğŸ‘¥ ç”¨æˆ·ç¾¤ä½“åˆ†æ

| ç”¨æˆ·ç±»å‹ | æ ¸å¿ƒéœ€æ±‚ | æœ¬æ–¹æ¡ˆä»·å€¼ |
|---------|---------|-----------|
| **å¼€å‘è€…** | å¿«é€Ÿé›†æˆ AI èƒ½åŠ› | ğŸ› ï¸ å‡å°‘å¼€å‘å·¥ä½œé‡ |
| **äº§å“ç»ç†** | å¤šæ¨¡å‹å¯¹æ¯”æµ‹è¯• | ğŸ¯ ç»Ÿä¸€æµ‹è¯•å¹³å° |
| **ä¼ä¸šç”¨æˆ·** | ç¨³å®šå¯é çš„ AI æœåŠ¡ | ğŸ¢ ä¼ä¸šçº§ç¨³å®šæ€§ |
| **ç ”ç©¶äººå‘˜** | å¤š Agent å®éªŒ | ğŸ”¬ çµæ´»çš„ Agent ç®¡ç† |

## ğŸ”® æœªæ¥è§„åˆ’

### ğŸ¯ æŠ€æœ¯æ¼”è¿›è·¯çº¿å›¾

#### çŸ­æœŸç›®æ ‡ (v3.1 - v3.5) ğŸš€
- [ ] **æ€§èƒ½ç›‘æ§**ï¼šæ·»åŠ è¯·æ±‚ç»Ÿè®¡å’Œæ€§èƒ½æŒ‡æ ‡
- [ ] **ç¼“å­˜æœºåˆ¶**ï¼šå®ç°å“åº”ç¼“å­˜é™ä½å»¶è¿Ÿ
- [ ] **è´Ÿè½½å‡è¡¡**ï¼šå¤šä¸ªä¸Šæ¸¸å®ä¾‹è‡ªåŠ¨åˆ‡æ¢
- [ ] **é™æµä¿æŠ¤**ï¼šAPI è°ƒç”¨é¢‘ç‡é™åˆ¶

#### ä¸­æœŸç›®æ ‡ (v4.0) ğŸŒŸ
- [ ] **æ’ä»¶ç³»ç»Ÿ**ï¼šæ”¯æŒè‡ªå®šä¹‰å¤„ç†æ’ä»¶
- [ ] **é…ç½®ç•Œé¢**ï¼šWeb ç•Œé¢åŠ¨æ€ä¿®æ”¹é…ç½®
- [ ] **å¤šç§Ÿæˆ·**ï¼šæ”¯æŒå¤šä¸ªç»„ç»‡éš”ç¦»ä½¿ç”¨
- [ ] **å®¡è®¡æ—¥å¿—**ï¼šå®Œæ•´çš„æ“ä½œæ—¥å¿—è®°å½•

#### é•¿æœŸæ„¿æ™¯ (v5.0+) ğŸ‡
- [ ] **æ™ºèƒ½è·¯ç”±**ï¼šåŸºäºå†…å®¹è‡ªåŠ¨é€‰æ‹©æœ€ä½³ Agent
- [ ] **è”é‚¦å­¦ä¹ **ï¼šå¤šä¸ªç½‘å…³ååŒå·¥ä½œ
- [ ] **è¾¹ç¼˜è®¡ç®—**ï¼šå……åˆ†åˆ©ç”¨ Cloudflare å…¨çƒç½‘ç»œ
- [ ] **AI å¸‚åœº**ï¼šAgent æ’ä»¶ç”Ÿæ€ç³»ç»Ÿ

### ğŸ”§ æŠ€æœ¯å€ºåŠ¡ä¸æ”¹è¿›ç‚¹

#### å½“å‰é™åˆ¶ âš ï¸
1. **é…ç½®ç¡¬ç¼–ç **ï¼šéœ€è¦ä¿®æ”¹ä»£ç æ›´æ–°é…ç½®
2. **æ— æŒä¹…åŒ–**ï¼šé‡å¯åé…ç½®å’ŒçŠ¶æ€ä¸¢å¤±
3. **ç›‘æ§ç¼ºå¤±**ï¼šç¼ºä¹è¿è¡Œæ—¶ç›‘æ§å’Œå‘Šè­¦
4. **æµ‹è¯•è¦†ç›–**ï¼šéœ€è¦å¢åŠ è‡ªåŠ¨åŒ–æµ‹è¯•

#### æ”¹è¿›æ–¹æ¡ˆ ğŸ’¡
```javascript
// ç¤ºä¾‹ï¼šé…ç½®å¤–éƒ¨åŒ–
// å½“å‰ï¼šç¡¬ç¼–ç åœ¨ä»£ç ä¸­
const AGENT_MAPPING_CONFIG = { /* ... */ };

// æœªæ¥ï¼šä½¿ç”¨ KV å­˜å‚¨
const AGENT_CONFIG = await env.KV_STORE.get('agent_config');
```

## ğŸ“ é¡¹ç›®ç»“æ„

### ğŸ—‚ï¸ å®Œæ•´æ–‡ä»¶ç»“æ„

```
LyzrAI-2api-cfwork/
â”œâ”€â”€ ğŸ“„ worker.js                 # ğŸŒŸ ä¸»ç¨‹åºæ–‡ä»¶ (Cloudflare Worker)
â”œâ”€â”€ ğŸ“„ README.md                 # ğŸ“– é¡¹ç›®è¯´æ˜æ–‡æ¡£ (æœ¬æ–‡ä»¶)
â”œâ”€â”€ ğŸ“„ LICENSE                   # âš–ï¸ Apache 2.0 å¼€æºåè®®
â”œâ”€â”€ ğŸ“ docs/                     # ğŸ—‚ï¸ æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“„ deployment-guide.md   # ğŸš€ è¯¦ç»†éƒ¨ç½²æŒ‡å—
â”‚   â”œâ”€â”€ ğŸ“„ api-reference.md      # ğŸ”Œ API æ¥å£æ–‡æ¡£
â”‚   â””â”€â”€ ğŸ“„ troubleshooting.md    # ğŸ› æ•…éšœæ’é™¤æŒ‡å—
â”œâ”€â”€ ğŸ“ examples/                 # ğŸ’¡ ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ ğŸ“„ chatbox-config.json   # ğŸ¨ ChatBox é…ç½®ç¤ºä¾‹
â”‚   â”œâ”€â”€ ğŸ“„ lobechat-config.yaml  # ğŸ¤– LobeChat é…ç½®ç¤ºä¾‹
â”‚   â””â”€â”€ ğŸ“„ openwebui-config.json # ğŸŒ OpenWebUI é…ç½®ç¤ºä¾‹
â”œâ”€â”€ ğŸ“ scripts/                  # ğŸ”§ å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ ğŸ“„ deploy.sh             # âš¡ ä¸€é”®éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ ğŸ“„ config-generator.js   # ğŸ› ï¸ é…ç½®ç”Ÿæˆå™¨
â””â”€â”€ ğŸ“ tests/                    # ğŸ§ª æµ‹è¯•æ–‡ä»¶
    â”œâ”€â”€ ğŸ“„ api-test.js           # ğŸ”Œ API æ¥å£æµ‹è¯•
    â””â”€â”€ ğŸ“„ load-test.js          # ğŸ“Š è´Ÿè½½æ€§èƒ½æµ‹è¯•
```

### ğŸ” æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

#### `worker.js` - ä¸»ç¨‹åºæ–‡ä»¶ ğŸ¯
```javascript
// æ–‡ä»¶ç»“æ„æ¦‚è§ˆ
export default {
  async fetch(request, env, ctx) {
    // ğŸš€ Worker å…¥å£ç‚¹
  }
};

// é…ç½®åŒºåŸŸ
const GLOBAL_CONFIG = { /* ... */ };

// API å¤„ç†å™¨
async function handleApiRequest(request) { /* ... */ }

// æµå¼å¼•æ“
function createPseudoStream(fullText, modelName) { /* ... */ }

// Web ç•Œé¢
function handleGuiRequest(request) { /* ... */ }
```

## ğŸ› ï¸ æŠ€æœ¯ç»†èŠ‚

### ğŸ”¬ æ ¸å¿ƒæŠ€æœ¯æ ˆæ·±åº¦è§£æ

#### 1. Cloudflare Workers ğŸ—ï¸
**æŠ€æœ¯åŸç†**ï¼šåŸºäº V8 éš”ç¦»çš„ Serverless è®¡ç®—å¹³å°
```javascript
// æ‰§è¡Œç¯å¢ƒï¼šæ¯ä¸ªè¯·æ±‚åœ¨ç‹¬ç«‹éš”ç¦»ä¸­è¿è¡Œ
export default {
  async fetch(request, env, ctx) {
    // ğŸ§© æ¯ä¸ªè¯·æ±‚åˆ›å»ºæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡
    // âš¡ å†·å¯åŠ¨æ—¶é—´ < 5ms
    // ğŸŒ å…¨çƒ 200+ è¾¹ç¼˜èŠ‚ç‚¹
  }
};
```

**æŠ€æœ¯æ¥æº**ï¼šCloudflare å®˜æ–¹æ–‡æ¡£ + V8 Isolates è®ºæ–‡
**éš¾åº¦è¯„çº§**ï¼šâ­â­ (å®¹æ˜“ä¸Šæ‰‹)
**æ‰©å±•æ½œåŠ›**ï¼šâ­â­â­â­â­ (è¾¹ç¼˜è®¡ç®—æœªæ¥)

#### 2. ReadableStream API ğŸŒŠ
**æŠ€æœ¯åŸç†**ï¼šWeb Streams API çš„å®ç°
```javascript
const stream = new ReadableStream({
  async start(controller) {
    // ğŸ® æ‰‹åŠ¨æ§åˆ¶æ•°æ®æµ
    controller.enqueue(data); // â• æ·»åŠ æ•°æ®
    controller.close();       // ğŸ”š ç»“æŸæµ
  }
});
```

**æŠ€æœ¯æ¥æº**ï¼šMDN Web Docs + Streams æ ‡å‡†
**éš¾åº¦è¯„çº§**ï¼šâ­â­â­ (ä¸­ç­‰éš¾åº¦)
**æ‰©å±•æ½œåŠ›**ï¼šâ­â­â­â­ (å®æ—¶åº”ç”¨æ ¸å¿ƒ)

#### 3. Server-Sent Events (SSE) ğŸ“¡
**æŠ€æœ¯åŸç†**ï¼šåŸºäº HTTP çš„æœåŠ¡å™¨æ¨é€æŠ€æœ¯
```
data: {"content": "Hello"}
data: {"content": "World"}
data: [DONE]
```

**æŠ€æœ¯æ¥æº**ï¼šHTML æ ‡å‡† + OpenAI API è§„èŒƒ
**éš¾åº¦è¯„çº§**ï¼šâ­â­ (å®¹æ˜“å®ç°)
**æ‰©å±•æ½œåŠ›**ï¼šâ­â­â­ (å®æ—¶é€šä¿¡åŸºç¡€)

### ğŸ¯ å…ˆè¿›ä»£ç æ¨¡å¼è§£æ

#### 1. é…ç½®é©±åŠ¨æ¶æ„ ğŸ—ï¸
```javascript
// ğŸ¯ æ ¸å¿ƒæ€æƒ³ï¼šé€šè¿‡é…ç½®è€Œéä»£ç æ”¹å˜è¡Œä¸º
const AGENT_MAPPING_CONFIG = {
  AGENTS: {
    'Model-A': { agent_id: 'id1', api_key: 'key1' },
    'Model-B': { agent_id: 'id2', api_key: 'key2' }
    // ğŸ†• æ·»åŠ æ–°æ¨¡å‹åªéœ€ä¿®æ”¹é…ç½®ï¼Œæ— éœ€æ”¹åŠ¨ä»£ç 
  }
};
```

**è®¾è®¡æ¨¡å¼**ï¼šç­–ç•¥æ¨¡å¼ + é…ç½®å¤–åŒ–
**ä¼˜åŠ¿**ï¼šğŸ”„ çµæ´»æ‰©å±•ï¼ŒğŸ¯ æ˜“äºç»´æŠ¤

#### 2. å‡½æ•°å¼é”™è¯¯å¤„ç† ğŸ›¡ï¸
```javascript
// ğŸ›¡ï¸ ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æ¨¡å¼
try {
  const response = await upstreamAPI(request);
  return transformResponse(response);
} catch (error) {
  // ğŸ¯ ç»Ÿä¸€é”™è¯¯æ ¼å¼ï¼Œå‹å¥½é”™è¯¯ä¿¡æ¯
  return createErrorResponse(error, 'upstream_error');
}
```

**è®¾è®¡æ¨¡å¼**ï¼šå‡½æ•°å¼ç¼–ç¨‹ + å¼‚å¸¸å°è£…
**ä¼˜åŠ¿**ï¼šğŸ”’ ä»£ç å¥å£®ï¼ŒğŸ¨ ç”¨æˆ·ä½“éªŒå¥½

#### 3. å“åº”å¼ UI ç»„ä»¶ ğŸ¨
```javascript
// ğŸ¨ å‰ç«¯çŠ¶æ€ç®¡ç†æ¨¡å¼
function setLoadingState(isLoading) {
  // ğŸ¯ ç»Ÿä¸€ç®¡ç†åŠ è½½çŠ¶æ€
  sendButton.disabled = isLoading;
  sendButtonText.textContent = isLoading ? 'æ€è€ƒä¸­...' : 'å‘é€';
}
```

**è®¾è®¡æ¨¡å¼**ï¼šçŠ¶æ€æ¨¡å¼ + å“åº”å¼æ›´æ–°
**ä¼˜åŠ¿**ï¼šâš¡ äº¤äº’æµç•…ï¼ŒğŸ­ ç”¨æˆ·ä½“éªŒä¼˜ç§€

## ğŸ¤ è´¡çŒ®æŒ‡å—

### ğŸ¯ å¦‚ä½•å‚ä¸è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼ğŸ‰

#### ä»£ç è´¡çŒ® ğŸ’»
1. **Fork é¡¹ç›®** ğŸ´
2. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯** ğŸŒ¿
   ```bash
   git checkout -b feature/AmazingFeature
   ```
3. **æäº¤æ›´æ”¹** ğŸ“
   ```bash
   git commit -m 'Add some AmazingFeature'
   ```
4. **æ¨é€åˆ°åˆ†æ”¯** ğŸš€
   ```bash
   git push origin feature/AmazingFeature
   ```
5. **åˆ›å»º Pull Request** ğŸ”„

#### æ–‡æ¡£æ”¹è¿› ğŸ“š
- ä¿®æ­£é”™åˆ«å­—å’Œè¯­æ³•é”™è¯¯
- è¡¥å……ä½¿ç”¨ç¤ºä¾‹å’Œæ•™ç¨‹
- ç¿»è¯‘ä¸ºå…¶ä»–è¯­è¨€ç‰ˆæœ¬

#### é—®é¢˜åé¦ˆ ğŸ›
- æäº¤ Bug æŠ¥å‘Š
- æå‡ºåŠŸèƒ½å»ºè®®
- åˆ†äº«ä½¿ç”¨ç»éªŒ

### ğŸ† è´¡çŒ®è€…è£èª‰å¢™

æˆ‘ä»¬å°†ä¸ºè´¡çŒ®è€…å»ºç«‹è£èª‰å¢™ï¼Œæ„Ÿè°¢ä½ ä»¬çš„ä»˜å‡ºï¼ğŸ–ï¸
---

<div align="center">

## ğŸ‰ æ„Ÿè°¢ä½¿ç”¨ Lyzr AI æ——èˆ°æ™ºèƒ½æ¢çº½ï¼

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ Star æ”¯æŒï¼**

[![Star History Chart](https://api.star-history.com/svg?repos=lzA6/LyzrAI-2api-cfwork&type=Date)](https://star-history.com/#lzA6/LyzrAI-2api-cfwork&Date)

**âœ¨ è®© AI æ›´æ™ºèƒ½ï¼Œè®©å¼€å‘æ›´ç®€å•ï¼ âœ¨**

</div>

---

### ğŸ”— ç›¸å…³é“¾æ¥
- ğŸ“– **è¯¦ç»†æ–‡æ¡£**: [æŸ¥çœ‹å®Œæ•´æ–‡æ¡£](docs/)
- ğŸ› **é—®é¢˜åé¦ˆ**: [æäº¤ Issue](https://github.com/lzA6/LyzrAI-2api-cfwork/issues)
- ğŸ’¡ **åŠŸèƒ½å»ºè®®**: [å‚ä¸è®¨è®º](https://github.com/lzA6/LyzrAI-2api-cfwork/discussions)
- ğŸ”„ **æ›´æ–°æ—¥å¿—**: [æŸ¥çœ‹ç‰ˆæœ¬å†å²](CHANGELOG.md)

### ğŸ“ è”ç³»æˆ‘ä»¬
- ğŸ’¼ **é¡¹ç›®ä¸»é¡µ**: [GitHub Repository](https://github.com/lzA6/LyzrAI-2api-cfwork)
- ğŸ¦ **æŠ€æœ¯äº¤æµ**: [Twitter @YourHandle](https://twitter.com/YourHandle)
- ğŸ’¬ **ç¤¾åŒºè®¨è®º**: [Discord Server](YourDiscordLink)

---

<div align="center">

**ğŸŒŸ æ˜Ÿæ˜Ÿä¹‹ç«ï¼Œå¯ä»¥ç‡åŸ - æ¯ä¸€ä¸ª â­ éƒ½æ˜¯æˆ‘ä»¬å‰è¿›çš„åŠ¨åŠ›ï¼**

*ç”±ä¸–ç•Œçº§çš„ Serverless æ¶æ„å¸ˆä¸å…¨æ ˆå¼€å‘ä¸“å®¶ä¸ºæ‚¨ç²¾å¿ƒæ‰“é€ çš„è‰ºæœ¯å“çº§åº”ç”¨*

</div>
